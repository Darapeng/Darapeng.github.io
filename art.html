<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>作品分享互動網頁</title>
<link rel="icon" type="image/png" href="palette.png">

<style>
body {
    font-family: Arial, sans-serif;
    background-color: #BEE7FF;
    padding: 20px;
}
.container {
    width: 75%;
    margin: auto;
    background: white;
    padding: 20px;
    border-radius: 10px;
}
h1, h2 { text-align: center; }

.top-bar {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
    margin-bottom: 10px;
}

.art-display {
    width: 100%;
    height: 300px;
    border: 2px dashed #aaa;
    border-radius: 10px;
    object-fit: contain;
    margin-bottom: 10px;
}

.work-list img {
    width: 120px;
    height: 120px;
    object-fit: cover;
    margin: 5px;
    cursor: pointer;
    border-radius: 8px;
    border: 2px solid #ccc;
}

.comment {
    background: #f1f1f1;
    padding: 6px;
    margin-top: 5px;
    border-radius: 5px;
}
textarea { width: 100%; padding: 8px; }
button { padding: 6px 12px; cursor: pointer; }

.delete-btn {
    background: #f44336;
    color: white;
    border: none;
    border-radius: 6px;
}
.upload-btn {
    background: #4CAF50;
    color: white;
    border: none;
    border-radius: 6px;
}
</style>
</head>
<body>

<div class="container">
<h1>作品分享互動網頁</h1>

<div class="top-bar">
    <button class="delete-btn" onclick="deleteWork()">刪除作品</button>
    <input type="file" id="fileInput" accept="image/*" hidden>
    <button class="upload-btn" onclick="fileInput.click()">上傳作品</button>
</div>

<img id="preview" class="art-display">

<h2>作品列表（點擊選取）</h2>
<div id="workList"></div>

<hr>

<h2>留言區</h2>
<textarea id="commentInput" rows="3" placeholder="輸入留言..."></textarea>
<button onclick="addComment()">送出留言</button>
<div id="commentList"></div>

</div>

<script>
let works = JSON.parse(localStorage.getItem("works")) || [];
let currentIndex = null;

// 初始化
window.onload = function () {
    works.forEach((_, i) => addImageToList(i));
};

// 上傳圖片
fileInput.addEventListener("change", function(e){
    const file = e.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function(){
        works.push({ image: reader.result, comments: [] });
        saveWorks();
        addImageToList(works.length - 1);
    };
    reader.readAsDataURL(file);
});

// 顯示作品縮圖
function addImageToList(index){
    const img = document.createElement("img");
    img.src = works[index].image;
    img.onclick = function(){ selectWork(index); };
    document.getElementById("workList").appendChild(img);
}

// 選取作品
function selectWork(index){
    currentIndex = index;
    preview.src = works[index].image;
    showComments();
}

// 顯示留言
function showComments(){
    const list = document.getElementById("commentList");
    list.innerHTML = "";
    works[currentIndex].comments.forEach(c => {
        const div = document.createElement("div");
        div.className = "comment";
        div.textContent = c;
        list.appendChild(div);
    });
}

// 新增留言
function addComment(){
    if (currentIndex === null) {
        alert("請先選擇作品！");
        return;
    }
    const text = commentInput.value.trim();
    if (!text) return;

    works[currentIndex].comments.push(text);
    commentInput.value = "";
    saveWorks();
    showComments();
}

// 刪除作品
function deleteWork(){
    if (currentIndex === null) {
        alert("請先選擇作品！");
        return;
    }
    if (!confirm("確定要刪除這件作品？")) return;

    works.splice(currentIndex, 1);
    saveWorks();
    location.reload();
}

// 儲存
function saveWorks(){
    localStorage.setItem("works", JSON.stringify(works));
}
</script>

</body>
</html>
